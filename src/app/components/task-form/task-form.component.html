<div class="task-form-container">
  <h2 mat-dialog-title>
    {{ isEditing ? 'Editar Tarea' : 'Nueva Tarea' }}
  </h2>

  <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
    <!-- Title Field -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Título de la tarea</mat-label>
      <input matInput
             formControlName="title"
             placeholder="Ingrese el título de la tarea"
             maxlength="100">
      <mat-hint align="end">{{ taskForm.get('title')?.value?.length || 0 }}/100</mat-hint>
      <mat-error *ngIf="taskForm.get('title')?.invalid && taskForm.get('title')?.touched">
        {{ getErrorMessage('title') }}
      </mat-error>
    </mat-form-field>

    <!-- Description Field -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Descripción (opcional)</mat-label>
      <textarea matInput
                formControlName="description"
                placeholder="Ingrese una descripción para la tarea"
                maxlength="500"
                rows="3"></textarea>
      <mat-hint align="end">{{ taskForm.get('description')?.value?.length || 0 }}/500</mat-hint>
      <mat-error *ngIf="taskForm.get('description')?.invalid && taskForm.get('description')?.touched">
        {{ getErrorMessage('description') }}
      </mat-error>
    </mat-form-field>

    <!-- Category Selection -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Categoría (opcional)</mat-label>
      <mat-select formControlName="categoryId">
        <mat-option value="">
          <em>Sin categoría</em>
        </mat-option>
        <mat-option *ngFor="let category of categories" [value]="category.id">
          <div class="category-option">
            <div class="category-color" [style.background-color]="category.color"></div>
            {{ category.name }}
          </div>
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button"
              mat-stroked-button
              (click)="onCancel()"
              class="cancel-button">
        Cancelar
      </button>
      <button type="submit"
              mat-raised-button
              color="primary"
              [disabled]="taskForm.invalid"
              class="submit-button">
        <mat-icon>{{ isEditing ? 'edit' : 'add' }}</mat-icon>
        {{ isEditing ? 'Actualizar' : 'Crear' }} Tarea
      </button>
    </div>
  </form>
</div>